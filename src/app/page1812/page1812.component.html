<div class="sidebar">
  <div class="MenuButton" (click)="ValidBar()">
    <p>Valider</p>
  </div>
  <div class="TitlePage">
    <p>Bar {{ BarId }}</p>
  </div>
  <div class="CancelButton" routerLink="/181/{{BarId}}">
    <p>X</p>
  </div>
</div>
<div class="container" style="overflow-y: auto;">
  <div class="tarifSelect">
    <select (change)="tarifBarChange($event.target.value)" [ngModel]="SelectedTarifId">
      <option *ngFor="let tb of TarifBarList" [ngValue]="tb.TarifBarId">{{tb.TarifBarName}}</option>
    </select>
  </div>
  <div class="d1" id="source">
    <div class="tableCategory" *ngFor="let cat of ProductCategories">
      <table>
        <thead>
          <tr>
            <th id="ProductName" colspan="3" scope="colgroup">
              <div class="CategoryName">
                {{cat.ProductCategoryName}}
              </div>
            </th>
          </tr>
          <tr>
            <th id="ProductName" scope="col">
              <div class="ProductTable">
                {{Product}}
              </div>
            </th>
            <th id="Quant" class="headcol" scope="col">
              <div class="QuantTable">
                {{ Quant }}
              </div>
            </th>
            <th id="Dose" class="headcol" scope="col">
              <div class="QuantTable">
                {{ Dose }}
              </div>
            </th>
          </tr>
        </thead>
        <tbody class="tableBody" style="border:none">
          <tr *ngFor="let prod of cat.Products; let i = index" style="border:none;">
            <th style="background: #5A5A5A; color: white; border: 1px solid #5A5A5A; text-align: center;" class="productNameRow" contenteditable="true" >
              {{prod.ProductName}}
            </th>
            <th style="background: #5A5A5A; color: white; border: 1px solid #5A5A5A; text-align: center;" contenteditable="true">
              {{prod.QteStock}}
            </th>
            <th style="background: #5A5A5A; color: white; border: 1px solid #5A5A5A; text-align: center;" contenteditable="true">
              <div *ngIf='prod.ProductName != ""'>
                {{prod.UniteTypeMsg ? 'Gr' : 'Cl'}}
              </div>
            </th>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="d2" id="target">
    <div class="tableCategory" *ngFor="let cat of ProductCategories">
      <table>
        <thead>
          <tr>
            <th style="border: none;" rowspan="2">
              <div class="GreenCaseTitle">
                <span>
                  {{ DosageCLGR }}
                </span>
              </div>
            </th>
            <th style="border: none;" rowspan="2">
              <div class="GreenCaseTitle">
                {{ PriceVenteTTC }}
              </div>
            </th>
            <th style="border: none;" rowspan="2">
              <div class="GreenCaseTitle" style="font-size: 12px;">
                {{ IdealStock }}
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none" colspan="2">
              <div class="GreenCaseTitleThrid">
                {{ InitialStock }}
              </div>
            </th>
            <th style="border:none" colspan="2">
              <div class="GreenCaseTitleThrid">
                {{ StockMovement }}
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none" colspan="2">
              <div class="GreenCaseTitleThrid">
                Stock Final théorique
              </div>
            </th>
            <th style="border:none" colspan="3">
              <div class="GreenCaseTitleThrid">
                Doses pointées
              </div>
            </th>
            <th style="border: none;" rowspan="2">
              <div class="GreenCaseTitle">
                Reappro auto En cours
              </div>
            </th>
            <th style="border: none;" rowspan="2">
              <div class="GreenCaseTitle">
                Reappro auto fin
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none" colspan="3">
              <div class="RedCaseTitleThrid">
                Stock Final théorique
              </div>
            </th>
            <th style="border: none;" rowspan="2">
              <div class="RedCaseTitle">
                Doses manu
              </div>
            </th>
            <th style="border: none;" rowspan="2">
              <div class="RedCaseTitle">
                Réappro manu
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none" colspan="2">
              <div class="BlueCaseTitleThrid">
                Stock Final à reporter
              </div>
            </th>
            <th style="border: none;" rowspan="2">
              <div class="BlueCaseTitle">
                Doses vendues
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none" colspan="3">
              <div class="BlackCaseTitleThrid">
                Rupture de stock
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none" colspan="3">
              <div class="BlackCaseTitleThrid">
                Total
              </div>
            </th>
          </tr>
          <tr>
            <th></th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                {{ BoutPleines }}
              </div>
            </th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                {{ DoseRestante }}
              </div>
            </th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                {{ Entry }}
              </div>
            </th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                {{ Out }}
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                Bouteilles pleines
              </div>
            </th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                Doses restantes bout entamée
              </div>
            </th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                Bar
              </div>
            </th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                Serveur
              </div>
            </th>
            <th style="border:none">
              <div class="GreenCaseTitleSecond">
                Total
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none">
              <div class="RedCaseTitleSecond">
                Manque bout
              </div>
            </th>
            <th style="border:none">
              <div class="RedCaseTitleSecond">
                Poids bout en gr
              </div>
            </th>
            <th style="border:none">
              <div class="RedCaseTitleSecond">
                Doses restantes bout entamée
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none">
              <div class="BlueCaseTitleSecond">
                Bouteilles
              </div>
            </th>
            <th style="border:none">
              <div class="BlueCaseTitleSecond">
                Doses
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none">
              <div class="BlackCaseTitleSecond">
                Bar
              </div>
            </th>
            <th style="border:none">
              <div class="BlackCaseTitleSecond">
                Réserve
              </div>
            </th>
            <th style="border:none">
              <div class="BlackCaseTitleSecond">
                Autres bars
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="border:none">
              <div class="BlackCaseTitleSecond">
                0
              </div>
            </th>
          </tr>
        </thead>
        <tbody class="tableBody" style="border:none;">
          <tr *ngFor="let prod of cat.Products; let i = index" style="border:none;">
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != '' && cat.DosageCl == 0; else elseBlock">
                {{prod.QteStock}}
              </div>
              <ng-template #elseBlock>{{cat.DosageCl}}</ng-template>                            
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                <div *ngIf="SelectedTarifId == 1">
                  {{prod.TarifCompta | number: '1.2'}} €
                </div>
                <div *ngIf="SelectedTarifId == 2">
                  {{prod.Tarif1 | number: '1.2'}} €
                </div>
                <div *ngIf="SelectedTarifId == 3">
                  {{prod.Tarif2 | number: '1.2'}} €
                </div>
                <div *ngIf="SelectedTarifId == 4">
                  {{prod.TarifVIP | number: '1.2'}} €
                </div>
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" 
              (click)="openDialogUpdate('Modifié Stock idéal', IdealStock, prod, 'idealStock')" #IdealStock contenteditable="true">
              <div *ngIf="prod.ProductName != ''">
                {{prod.IdealStock}}
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" >
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #E2EFDA; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="background: #FCE4D6; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #FCE4D6; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #FCE4D6; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #FCE4D6; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #FCE4D6; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="background: #D9E1F2; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #D9E1F2; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: #D9E1F2; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="background: yellow; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: orange; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th style="background: red; color: black; border: 1px solid black; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0
              </div>
            </th>
            <th width="25px" style="visibility:hidden;"></th>
            <th style="background: gray; color: white; border: 1px solid gray; text-align: center;" contenteditable="false">
              <div *ngIf="prod.ProductName != ''">
                0,00 €
              </div>
            </th>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>